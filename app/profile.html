<!DOCTYPE html>
<html>
<head>
	<title>Create Profile</title>
	<meta charset="utf-8"> 
	<link rel="shortcut icon" href="img/icon.png" />
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css" />
	<link rel="stylesheet" href="css/jquery.mobile.theme-1.4.5.min.css" />
	<style type="text/css">

		#spinner{
			width: 100%;
			height: 100%;
			background: none repeat scroll 0% 0% rgba(162, 224, 234, 0.89);
			position: absolute;
			z-index: 100;
			text-align: center;
			display: none;
		}

		#error{
			color:red;
			display: none;
			margin-bottom: 1em;
		}

	</style>
	<script src="js/var.js"></script>
	<script src="js/jquery.min.js"></script>
	<script src="js/jquery.mobile-1.4.5.min.js"></script>
</head>

<body>
	<div id="spinner">
		<br/><br/>
		<h1>Please Wait...</h1>

	</div>
	<div data-role="page">


		<div data-role="header" style="overflow:hidden;">
			<h1>Create Profile</h1>
			<a href="front.html" data-ajax="false" data-icon="home" class="ui-btn-left">Home</a>
			<!-- <a href="login.html" data-ajax="false" data-icon="gear" class="ui-btn-right" id="btnLogin"></a> -->

		</div><!-- /header -->

		<div role="main" class="ui-content">
			<div id="error"></div>

            <select name="user" id="bgroup" data-theme="a">
			
				<option value="select">Select BG</option>
				<option value="A+">A+</option>
				<option value="A-">A-</option>
				<option value="B+">B+</option>
				<option value="B-">B-</option>
				<option value="O+">O+</option>
				<option value="O-">O-</option>
				<option value="AB+">AB+</option>
				<option value="AB_">AB-</option>
			<br/>
			<input name="text-basic" id="pincode" autocomplete="on" value="" type="number" placeholder="Pincode">
			<input name="text-basic" id="year" autocomplete="on" value="" type="number" placeholder="year of birth">
			<br/>

			<button class="ui-btn ui-btn-b" onClick="create()">Create</button>
			<button class="ui-btn ui-btn-a" onClick="clear()">Clear</button>

			</div><!-- /content -->

		</div><!-- /page -->

		<script>
			check();
			function clear(){

		//	$('#loginForm').trigger("reset");
	}

	function check(){
		hasprofile=localStorage.hasprofile;
		if(typeof hasprofile != 'undefined' && hasprofile != null){
			window.location="viewprofile.html"
		}
	}

	function create(){
		email=localStorage.email;
		pass=localStorage.password;
		bloodgroup = $('#bgroup').val();
		year=$('#year').val();
		pincode=$('#pincode').val();
		console.log(email);
		console.log(pass);
		if(typeof email == 'undefined' || email == null || pass == 'undefined' || pass == null){
			showError("Please Login");
		} else if(bloodgroup=="select"){
			showError("Select a bloodgroup");
		} else if(pincode==""){
			showError("Enter Pincode");
			console.log(bloodgroup);
		} else if(year==""){
			showError("Enter Year");
		} else {
			// spinner.show();
			$.post(server+'createprofile.php',{'email':email, 'password':pass, 'bloodgroup':bloodgroup, 'branch':pincode, 'year':year},function(data,status){
				// spinner.hide();
				if(status=='success'){
					console.log(data);
					data = $.parseJSON(data);
					if(data['status']==0)
						showError(data['error']);
					else{
						localStorage.hasprofile=true;
						window.location="front.html";
					}
				}else{
					console.log('failed');
				}
			});

		}
	}

	function showError(data){
		$('#error').slideDown();
		$('#error').html(data);
		setTimeout(function(){
			$('#error').slideUp();
		},5000);
	}


</script>

</body>


</html>
